# YouTube Cookie Setup Guide

This guide will help you set up YouTube cookies to bypass bot detection and improve your API's success rate.

## Why Cookies Are Needed

YouTube has implemented bot detection systems that can block automated requests. Adding cookies from a logged-in YouTube account helps bypass these restrictions by making your requests appear more like they're coming from a real user.

## Method 1: Chrome Extension (Recommended)

### Step 1: Install Extension
1. Go to the [Chrome Web Store](https://chrome.google.com/webstore/detail/get-cookiestxt/bgaddhkoddajcdgocldbbfleckgcbcid)
2. Install "Get cookies.txt" extension
3. Restart Chrome

### Step 2: Get YouTube Cookies
1. Go to https://www.youtube.com
2. **Sign in** to your YouTube/Google account
3. Click the "Get cookies.txt" extension icon in your toolbar
4. Click "Export" 
5. Select "youtube.com" from the domain list
6. Click "Export" to download the cookies.txt file

### Step 3: Add to Your Project
1. Rename the downloaded file to `cookies.txt`
2. Place it in the root directory of your project (same level as `main.py`)
3. Commit and push to your GitHub repository

## Method 2: Firefox Extension

### Step 1: Install Extension
1. Go to [Firefox Add-ons](https://addons.mozilla.org/en-US/firefox/addon/cookie-quick-manager/)
2. Install "Cookie Quick Manager" extension
3. Restart Firefox

### Step 2: Get YouTube Cookies
1. Go to https://www.youtube.com
2. **Sign in** to your YouTube/Google account
3. Click the "Cookie Quick Manager" extension icon
4. Click "Export" → "Export to cookies.txt"
5. Select "youtube.com" domain
6. Save the file as `cookies.txt`

### Step 3: Add to Your Project
1. Place the `cookies.txt` file in your project root
2. Commit and push to your GitHub repository

## Method 3: Manual Extraction

### Step 1: Access Browser Cookies
1. Go to https://www.youtube.com and sign in
2. Open Developer Tools (F12)
3. Go to Application/Storage tab
4. Click on "Cookies" → "https://www.youtube.com"

### Step 2: Extract Important Cookies
Look for these important cookies and copy their values:
- `SID`
- `HSID`
- `SSID`
- `APISID`
- `SAPISID`
- `__Secure-1PSID`
- `__Secure-3PSID`
- `__Secure-1PAPISID`
- `__Secure-3PAPISID`
- `VISITOR_INFO1_LIVE`
- `LOGIN_INFO`

### Step 3: Create cookies.txt File
Create a file named `cookies.txt` with the following format:

```
# Netscape HTTP Cookie File
# https://curl.se/rfc/cookie_spec.html
# This file was generated by youtube-dl.  Do not edit.

.youtube.com	TRUE	/	FALSE	1735689600	SID	your_sid_value_here
.youtube.com	TRUE	/	FALSE	1735689600	HSID	your_hsid_value_here
.youtube.com	TRUE	/	FALSE	1735689600	SSID	your_ssid_value_here
.youtube.com	TRUE	/	FALSE	1735689600	APISID	your_apisid_value_here
.youtube.com	TRUE	/	FALSE	1735689600	SAPISID	your_sapisid_value_here
.youtube.com	TRUE	/	FALSE	1735689600	__Secure-1PSID	your_secure_1psid_value_here
.youtube.com	TRUE	/	FALSE	1735689600	__Secure-3PSID	your_secure_3psid_value_here
.youtube.com	TRUE	/	FALSE	1735689600	__Secure-1PAPISID	your_secure_1papisid_value_here
.youtube.com	TRUE	/	FALSE	1735689600	__Secure-3PAPISID	your_secure_3papisid_value_here
.youtube.com	TRUE	/	FALSE	1735689600	VISITOR_INFO1_LIVE	your_visitor_info_value_here
.youtube.com	TRUE	/	FALSE	1735689600	LOGIN_INFO	your_login_info_value_here
```

**Important Notes:**
- Replace `your_*_value_here` with actual cookie values from your browser
- The expiration timestamp (1735689600) should be a future date in Unix timestamp format
- You can use an online converter to get the current timestamp + 1 year

## Testing Your Cookies

After setting up cookies, test your setup:

```bash
python test_setup.py
```

This will verify that your cookies are working and your API can access YouTube videos.

## Troubleshooting

### Cookies Not Working
1. **Check file format**: Ensure the cookies.txt file follows the Netscape format exactly
2. **Verify domain**: Make sure all cookies are for `.youtube.com` domain
3. **Check expiration**: Ensure cookie expiration dates are in the future
4. **Re-export**: Try re-exporting cookies from your browser

### Still Getting Bot Detection
1. **Use a different account**: Try with a different YouTube account
2. **Clear browser cookies**: Clear your browser cookies and sign in again
3. **Wait and retry**: YouTube's bot detection can be temporary
4. **Check IP**: Some IP addresses may be flagged by YouTube

### Cookie File Not Found
1. **Check file location**: Ensure `cookies.txt` is in the project root
2. **Check file name**: The file must be named exactly `cookies.txt`
3. **Check permissions**: Ensure the file is readable by the application

## Security Notes

⚠️ **Important Security Considerations:**

1. **Don't share cookies**: Never commit cookies to public repositories
2. **Use environment variables**: Consider using environment variables for sensitive data
3. **Rotate cookies**: Regularly update your cookies (they expire)
4. **Monitor usage**: Keep track of your API usage to avoid rate limits

## Alternative: Environment Variable

You can also specify a custom cookie file path using an environment variable:

```bash
export YOUTUBE_COOKIE_FILE=/path/to/your/cookies.txt
```

Or in Render, add it as an environment variable:
- Key: `YOUTUBE_COOKIE_FILE`
- Value: `/opt/render/project/src/cookies.txt`

## Next Steps

After setting up cookies:
1. Deploy your application to Render
2. Test the `/song/{song_id}/stream` endpoint
3. Monitor your application logs for any issues
4. Use the `/song/{song_id}/test` endpoint to verify video accessibility

For more help, check the main README.md file or the troubleshooting section.
